<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Scientific Calculator</title>
  <style>
    :root{
      --bg:#0f1724; --panel:#111827; --accent:#06b6d4; --muted:#94a3b8; --glass: rgba(255,255,255,0.03);
      --btn:#0b1220; --btn-shade: rgba(0,0,0,0.35);
    }
    *{box-sizing:border-box}
    body{
      font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;
      margin:0; min-height:100vh;
      display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg,#071028 0%, #081225 60%);
      color:#e6eef6;
    }
    .calculator{
      width:420px; max-width:96vw;
      background:linear-gradient(180deg,var(--panel), #0b1220);
      border-radius:14px; padding:18px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
    }
    .display{background:var(--glass); padding:14px; border-radius:10px; margin-bottom:12px}
    .secondary{font-size:13px; color:var(--muted); min-height:18px}
    .main{font-size:26px; text-align:right; padding-top:6px; word-break:break-all}
    .controls{display:flex; gap:8px; margin-bottom:12px}
    .toggle{margin-left:auto; display:flex; gap:6px; align-items:center}
    .btn{
      background:var(--btn); border-radius:8px; padding:10px 12px;
      border:none; color:inherit; cursor:pointer;
      box-shadow:0 4px 8px var(--btn-shade); font-weight:600
    }
    .btn:active{transform:translateY(1px)}
    .kbd-hint{font-size:12px; color:var(--muted)}
    .keys{display:grid; grid-template-columns: repeat(6,1fr); gap:8px}
    .key{
      padding:14px; border-radius:8px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.15));
      text-align:center; cursor:pointer; user-select:none
    }
    .key.op{background:transparent; color:var(--accent); font-weight:700}
    .key.func{font-size:13px}
    .key.wide{grid-column: span 2}
    .key.equal{background:linear-gradient(90deg,var(--accent), #3b82f6); color:#072033; font-weight:800}
    footer{margin-top:12px; font-size:12px; color:var(--muted); text-align:center}
    @media (max-width:420px){ .keys{grid-template-columns: repeat(5,1fr);} }
  </style>
</head>
<body>
  <div class="calculator">
    <div class="display" id="display">
      <div class="secondary">Mode: <strong id="angleMode">DEG</strong> • Ans: <span id="ans">0</span></div>
      <div class="main" id="expr">0</div>
    </div>

    <div class="controls">
      <div class="kbd-hint">Keyboard: numbers, + - * / . ( ) ^ Enter = Backspace</div>
      <div class="toggle">
        <button class="btn" id="clear">C</button>
        <button class="btn" id="back">⌫</button>
        <button class="btn" id="mode">DEG</button>
      </div>
    </div>

    <div class="keys" id="keys">
      <div class="key func" data-val="sin(">sin</div>
      <div class="key func" data-val="cos(">cos</div>
      <div class="key func" data-val="tan(">tan</div>
      <div class="key func" data-val="asin(">asin</div>
      <div class="key func" data-val="acos(">acos</div>
      <div class="key func" data-val="atan(">atan</div>

      <div class="key func" data-val="ln(">ln</div>
      <div class="key func" data-val="log10(">log</div>
      <div class="key func" data-val="sqrt(">√</div>
      <div class="key func" data-val="pow(">xʸ</div>
      <div class="key func" data-val="!">n!</div>
      <div class="key func" data-val="%">%</div>

      <div class="key" data-val="7">7</div>
      <div class="key" data-val="8">8</div>
      <div class="key" data-val="9">9</div>
      <div class="key op" data-val="/">÷</div>
      <div class="key func" data-val="(">(</div>
      <div class="key func" data-val=")">)</div>

      <div class="key" data-val="4">4</div>
      <div class="key" data-val="5">5</div>
      <div class="key" data-val="6">6</div>
      <div class="key op" data-val="*">×</div>
      <div class="key func" data-val="pi">π</div>
      <div class="key func" data-val="e">e</div>

      <div class="key" data-val="1">1</div>
      <div class="key" data-val="2">2</div>
      <div class="key" data-val="3">3</div>
      <div class="key op" data-val="-">−</div>
      <div class="key func" data-val="ANS">Ans</div>
      <div class="key func" data-val="M">M</div>

      <div class="key" data-val="0">0</div>
      <div class="key" data-val=".">.</div>
      <div class="key wide" data-val="=" id="equals">=</div>
      <div class="key op" data-val="+">+</div>
      <div class="key func" data-val=",">,</div>
      <div class="key func" data-val="^">^</div>
    </div>

    <footer>Tip: use Enter to evaluate. Angle mode affects trig functions.</footer>
  </div>

  <script>
    (function(){
      const exprEl = document.getElementById('expr');
      const ansEl = document.getElementById('ans');
      const modeBtn = document.getElementById('mode');
      let expr = '', lastAns = 0, memory = 0, angleMode = 'DEG';

      const render = ()=>{ exprEl.textContent = expr || '0'; ansEl.textContent = lastAns; document.getElementById('angleMode').textContent = angleMode; };
      const push = v => { expr += v; render(); };
      const clearAll = ()=>{ expr=''; render(); };
      const back = ()=>{ expr = expr.slice(0,-1); render(); };

      const evalExpression = input => {
        if(!input) return 0;
        input = input.replace(/%/g,'/100').replace(/pi/gi,`(${Math.PI})`).replace(/e/g,`(${Math.E})`)
          .replace(/ANS/g,`(${lastAns})`).replace(/M/g,`(${memory})`).replace(/(\\d+)!/g,(_,n)=>`fact(${n})`)
          .replace(/\\^/g,'**');
        const body = `
          const fact = n=>{n=Math.floor(n);if(n<0)return NaN;let r=1;for(let i=2;i<=n;i++)r*=i;return r};
          const __sin__ = x=>Math.sin(${angleMode==='DEG'?'x*Math.PI/180':'x'});
          const __cos__ = x=>Math.cos(${angleMode==='DEG'?'x*Math.PI/180':'x'});
          const __tan__ = x=>Math.tan(${angleMode==='DEG'?'x*Math.PI/180':'x'});
          const __asin__ = x=>${angleMode==='DEG'?'Math.asin(x)*180/Math.PI':'Math.asin(x)'};
          const __acos__ = x=>${angleMode==='DEG'?'Math.acos(x)*180/Math.PI':'Math.acos(x)'};
          const __atan__ = x=>${angleMode==='DEG'?'Math.atan(x)*180/Math.PI':'Math.atan(x)'};
          return (${input});
        `;
        try{ return new Function(body)(); }catch(e){ throw new Error('Invalid'); }
      };

      const compute = ()=>{
        try{
          const res = evalExpression(expr);
          if(typeof res==='number' && isFinite(res)){ lastAns=res; expr=String(res); }
          else expr='Error';
        }catch(e){ expr='Error'; }
        render();
      };

      document.getElementById('keys').addEventListener('click', e=>{
        const k = e.target.closest('.key'); if(!k) return;
        const v = k.dataset.val;
        if(v==='='){compute();return;}
        if(v==='ANS'){push(String(lastAns));return;}
        if(v==='M'){memory=lastAns;render();return;}
        if(v==='!'){push('!');return;}
        push(v);
      });

      document.getElementById('clear').onclick=clearAll;
      document.getElementById('back').onclick=back;
      modeBtn.onclick=()=>{angleMode=angleMode==='DEG'?'RAD':'DEG';modeBtn.textContent=angleMode;render();};

      window.onkeydown=e=>{
        if(e.key==='Enter'){compute();e.preventDefault();}
        else if(e.key==='Backspace'){back();}
        else if(e.key==='Delete'){clearAll();}
        else if(/^[0-9.+\\-*/()%,^]$/.test(e.key)){push(e.key);}
      };

      render();
    })();
  </script>
</body>
</html>
